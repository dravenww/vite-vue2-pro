import{n as e,_ as t,p as l}from"./index.1ce8a00d.js";import{a as i}from"./article.59c627c4.js";import"./vendor.ae19cf99.js";const a={};var o=e({props:{value:{type:String,default:""}},computed:{filename:{get(){return this.value},set(e){this.$emit("input",e)}}}},(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticStyle:{display:"inline-block"}},[l("label",{staticClass:"radio-label",staticStyle:{"padding-left":"0"}},[e._v("Filename: ")]),l("el-input",{staticStyle:{width:"345px"},attrs:{placeholder:"Please enter the file name (default excel-list)","prefix-icon":"el-icon-document"},model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}})],1)}),[],!1,(function(e){for(let t in a)this[t]=a[t]}),null,null,null);o.options.__file="src/views/excel/components/FilenameOption.vue";var n=o.exports;const s={props:{value:{type:Boolean,default:!0}},computed:{autoWidth:{get(){return this.value},set(e){this.$emit("input",e)}}}},r={};var c=e(s,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticStyle:{display:"inline-block"}},[l("label",{staticClass:"radio-label"},[e._v("Cell Auto-Width: ")]),l("el-radio-group",{model:{value:e.autoWidth,callback:function(t){e.autoWidth=t},expression:"autoWidth"}},[l("el-radio",{attrs:{label:!0,border:""}},[e._v(" True ")]),l("el-radio",{attrs:{label:!1,border:""}},[e._v(" False ")])],1)],1)}),[],!1,(function(e){for(let t in r)this[t]=r[t]}),null,null,null);c.options.__file="src/views/excel/components/AutoWidthOption.vue";var u=c.exports;const d={};var p=e({props:{value:{type:String,default:"xlsx"}},data:()=>({options:["xlsx","csv","txt"]}),computed:{bookType:{get(){return this.value},set(e){this.$emit("input",e)}}}},(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticStyle:{display:"inline-block"}},[l("label",{staticClass:"radio-label"},[e._v("Book Type: ")]),l("el-select",{staticStyle:{width:"120px"},model:{value:e.bookType,callback:function(t){e.bookType=t},expression:"bookType"}},e._l(e.options,(function(e){return l("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)}),[],!1,(function(e){for(let t in d)this[t]=d[t]}),null,null,null);p.options.__file="src/views/excel/components/BookTypeOption.vue";var f=p.exports;const m={};var h=e({name:"ExportExcel",components:{FilenameOption:n,AutoWidthOption:u,BookTypeOption:f},data:()=>({list:null,listLoading:!0,downloadLoading:!1,filename:"",autoWidth:!0,bookType:"xlsx"}),created(){this.fetchData()},methods:{fetchData(){this.listLoading=!0,i().then((e=>{this.list=e.data.items,this.listLoading=!1}))},handleDownload(){this.downloadLoading=!0,t((()=>import("./Export2Excel.2009f15d.js")),["/vite-vue2-pro/assets/Export2Excel.2009f15d.js","/vite-vue2-pro/assets/FileSaver.min.98bd1f62.js","/vite-vue2-pro/assets/vendor.ae19cf99.js","/vite-vue2-pro/assets/xlsx.ebd77e05.js"]).then((e=>{const t=this.list,l=this.formatJson(["id","title","author","pageviews","display_time"],t);e.export_json_to_excel({header:["Id","Title","Author","Readings","Date"],data:l,filename:this.filename,autoWidth:this.autoWidth,bookType:this.bookType}),this.downloadLoading=!1}))},formatJson:(e,t)=>t.map((t=>e.map((e=>"timestamp"===e?l(t[e]):t[e]))))}},(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"app-container"},[l("div",[l("FilenameOption",{model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}}),l("AutoWidthOption",{model:{value:e.autoWidth,callback:function(t){e.autoWidth=t},expression:"autoWidth"}}),l("BookTypeOption",{model:{value:e.bookType,callback:function(t){e.bookType=t},expression:"bookType"}}),l("el-button",{staticStyle:{margin:"0 0 20px 20px"},attrs:{loading:e.downloadLoading,type:"primary",icon:"el-icon-document"},on:{click:e.handleDownload}},[e._v(" Export Excel ")]),l("a",{staticStyle:{"margin-left":"15px"},attrs:{href:"https://panjiachen.github.io/vue-element-admin-site/feature/component/excel.html",target:"_blank"}},[l("el-tag",{attrs:{type:"info"}},[e._v("Documentation")])],1)],1),l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":"Loading...",border:"",fit:"","highlight-current-row":""}},[l("el-table-column",{attrs:{align:"center",label:"Id",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.$index)+" ")]}}])}),l("el-table-column",{attrs:{label:"Title"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.title)+" ")]}}])}),l("el-table-column",{attrs:{label:"Author",width:"110",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-tag",[e._v(e._s(t.row.author))])]}}])}),l("el-table-column",{attrs:{label:"Readings",width:"115",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.pageviews)+" ")]}}])}),l("el-table-column",{attrs:{align:"center",label:"Date",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("i",{staticClass:"el-icon-time"}),l("span",[e._v(e._s(e._f("parseTime")(t.row.timestamp,"{y}-{m}-{d} {h}:{i}")))])]}}])})],1)],1)}),[],!1,(function(e){for(let t in m)this[t]=m[t]}),null,null,null);h.options.__file="src/views/excel/export-excel.vue";var v=h.exports;export default v;
